import{_ as a,c as p,G as l,a0 as e,B as o,o as r}from"./chunks/framework.BDOpb1iH.js";const d=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"web/Package-management/常用的npm包.md","filePath":"web/Package-management/常用的npm包.md","lastUpdated":1733362906000}'),c={name:"web/Package-management/常用的npm包.md"};function t(i,s,B,y,u,b){const n=o("end-time");return r(),p("div",null,[l(n,{time:"新增时间: 2022-01-04"}),s[0]||(s[0]=e(`<details class="details custom-block"><summary>cross-env / dotenv</summary><blockquote><p>前言：我们很多时候会通过不同的打包命令控制环境变量，从而根据不同的环境变量调用相应的域名，达到一个测试环境和正式环境分离的目标。</p></blockquote><hr><p>在 <strong>macOS</strong> 我们一般可以直接通过命令参数传入环境变量，例如在 <strong>package.json</strong> 下传入 <strong>NODE_ENV变量</strong></p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// package.json</span></span>
<span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#98C379;">  &quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;xx&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">  &quot;version&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;0.0.1&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">  &quot;private&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">true</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">  &quot;scripts&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#98C379;">    &quot;serve&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;NODE_ENV=development &amp;&amp; vue-cli-service serve&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">    &quot;build&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;NODE_ENV=test vue-cli-service build&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">    &quot;build:prod&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;NODE_ENV=production vue-cli-service build&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">    ...</span></span>
<span class="line"><span style="color:#ABB2BF;">  },</span></span>
<span class="line"><span style="color:#ABB2BF;">  ...</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>在具体的业务代码里访问进程环境 <strong>process.env</strong> 里获得该变量，从而设置不同的请求域名</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// index.js</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> BASE_URL</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> process</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">env</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">NODE_ENV</span><span style="color:#56B6C2;"> ===</span><span style="color:#98C379;"> &#39;test&#39;</span><span style="color:#C678DD;"> ?</span><span style="color:#98C379;"> &#39;http://test.xx.com&#39;</span><span style="color:#C678DD;"> :</span><span style="color:#98C379;"> &#39;https://online.xx.com&#39;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><hr><p><strong>然而，上面的设置在windows系统下会报错，此时可以通过cross-env插件解决</strong></p><hr><p>接下来安装 <strong>cross-env</strong>插件</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#E06C75;">npm</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> --</span><span style="color:#E06C75;">save</span><span style="color:#56B6C2;">-</span><span style="color:#E06C75;">dev</span><span style="color:#E06C75;"> cross</span><span style="color:#56B6C2;">-</span><span style="color:#E06C75;">env</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// package.json</span></span>
<span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#98C379;">  &quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;xx&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">  &quot;version&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;0.0.1&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">  &quot;private&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">true</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">  &quot;scripts&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#98C379;">    &quot;serve&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;cross-env NODE_ENV=development &amp;&amp; vue-cli-service serve&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">    &quot;build&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;cross-env NODE_ENV=test vue-cli-service build&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">    &quot;build:prod&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;cross-env NODE_ENV=production vue-cli-service build&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">    ...</span></span>
<span class="line"><span style="color:#ABB2BF;">  },</span></span>
<span class="line"><span style="color:#ABB2BF;">  ...</span></span>
<span class="line"><span style="color:#98C379;">  &quot;devDependencies&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#98C379;">      &quot;cross-env&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;^6.0.3&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>接下来重新运行, 发现非常丝滑，我们可以通过执行不同的打包命令，去达成我们打不同环境的包的目的。</p><p>但是当业务越来越复杂的时候，我们需要设置的 <strong>不止一个域名，而且环境也很多套</strong> ，需要根据不同的环境去加载不同的环境变量参数，来维护这么一个映射关系，例如：</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// index.js</span></span>
<span class="line"><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> baseUrl</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;&#39;</span></span>
<span class="line"><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> paramA</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;&#39;</span></span>
<span class="line"><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> paramB</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;&#39;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// 第一套测试环境</span></span>
<span class="line"><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">process</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">env</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">NODE_ENV</span><span style="color:#56B6C2;"> ===</span><span style="color:#98C379;"> &#39;test1&#39;</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E06C75;">    baseUrl</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;http://test1.xx.com&#39;</span></span>
<span class="line"><span style="color:#E06C75;">    paramA</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;a&#39;</span></span>
<span class="line"><span style="color:#E06C75;">    paramB</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;b&#39;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// 第二套测试环境</span></span>
<span class="line"><span style="color:#ABB2BF;">} </span><span style="color:#C678DD;">else</span><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">process</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">env</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">NODE_ENV</span><span style="color:#56B6C2;"> ===</span><span style="color:#98C379;"> &#39;test2&#39;</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E06C75;">    baseUrl</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;http://test2.xx.com&#39;</span></span>
<span class="line"><span style="color:#E06C75;">    paramA</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;a2&#39;</span></span>
<span class="line"><span style="color:#E06C75;">    paramB</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;b2&#39;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// 预发环境</span></span>
<span class="line"><span style="color:#ABB2BF;">} </span><span style="color:#C678DD;">else</span><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">process</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">env</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">NODE_ENV</span><span style="color:#56B6C2;"> ===</span><span style="color:#98C379;"> &#39;pre&#39;</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E06C75;">    baseUrl</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;http://pre.xx.com&#39;</span></span>
<span class="line"><span style="color:#E06C75;">    paramA</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;preA&#39;</span></span>
<span class="line"><span style="color:#E06C75;">    paramB</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;preB&#39;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// 正式环境</span></span>
<span class="line"><span style="color:#ABB2BF;">} </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E06C75;">    baseUrl</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;http://online.xx.com&#39;</span></span>
<span class="line"><span style="color:#E06C75;">    paramA</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;onlineA&#39;</span></span>
<span class="line"><span style="color:#E06C75;">    paramB</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;onlineB&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>后面会觉得不够清晰简洁，因此引入了 <strong>dotenv</strong> ，它能将环境变量中的变量从 <strong>.env</strong> 文件中加载到 <strong>process.env</strong> 中，也可以很好地避免我们在业务代码中引入配置文件，避免安全问题以及更好地维护。</p><ul><li>安装 <strong>dotenv</strong> 插件</li></ul><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#E06C75;">npm</span><span style="color:#E06C75;"> i</span><span style="color:#56B6C2;"> --</span><span style="color:#E06C75;">save</span><span style="color:#56B6C2;">-</span><span style="color:#E06C75;">dev</span><span style="color:#E06C75;"> dotenv</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li>创建 <strong>.env.dev</strong>文件</li></ul><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#E5C07B;">BASE_URL</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;http://dev.xx.com&#39;</span></span>
<span class="line"><span style="color:#E5C07B;">PARAM_A</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;a&#39;</span></span>
<span class="line"><span style="color:#E5C07B;">PARAM_B</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;b&#39;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>创建 <strong>.env.test</strong>文件</li></ul><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#E5C07B;">BASE_URL</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;http://dev.xx.com&#39;</span></span>
<span class="line"><span style="color:#E5C07B;">PARAM_A</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;a&#39;</span></span>
<span class="line"><span style="color:#E5C07B;">PARAM_B</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;b&#39;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>创建 <strong>.env.prod</strong>文件</li></ul><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#E5C07B;">BASE_URL</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;http://prod.xx.com&#39;</span></span>
<span class="line"><span style="color:#E5C07B;">PARAM_A</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;a&#39;</span></span>
<span class="line"><span style="color:#E5C07B;">PARAM_B</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;b&#39;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>在配置文件中引入</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> path</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> require</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;path&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> customPath</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> path</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">process</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">cwd</span><span style="color:#ABB2BF;">(), </span><span style="color:#98C379;">\`.env.</span><span style="color:#C678DD;">\${</span><span style="color:#E5C07B;">process</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">env</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">NODE_ENV</span><span style="color:#C678DD;">}</span><span style="color:#98C379;">\`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#61AFEF;">require</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;dotenv&#39;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">config</span><span style="color:#ABB2BF;">({ </span><span style="color:#E06C75;">path</span><span style="color:#ABB2BF;">: </span><span style="color:#E06C75;">customPath</span><span style="color:#ABB2BF;"> });</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>在业务文件中打印</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">process</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">env</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">PARAM_A</span><span style="color:#ABB2BF;">) </span><span style="color:#7F848E;font-style:italic;">// 对应环境的变量</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div></details>`,1))])}const m=a(c,[["render",t]]);export{d as __pageData,m as default};
