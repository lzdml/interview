## 数组操作方法

::: details 根据一个数组 id 对另外一个数组进行排序并返回

```js
const initialArr = [
  {id: 2, name: "Alexa"},
  {id: 1, name: "John"},
  {id: 5, name: "Mary"},
  {id: 9, name: "Zuzu"},
  {id: 3, name: "Mary"},
  {id: 4, name: "Peter"},
];
const arr = [1, 2, 3, 4];

initialArr.sort((a, b) => {
  const getTypeIndex = (x) => arr.indexOf(x.id);

  return getTypeIndex(a) - getTypeIndex(b) && a.id - b.id;
});

console.log(initialArr);

// [
//   {id: 1, name: 'John'},
//   {id: 2, name: 'Alexa'},
//   {id: 3, name: 'Mary'},
//   {id: 4, name: 'Peter'},
//   {id: 5, name: 'Mary'},
//   {id: 9, name: 'Zuzu'}
// ]
```

:::

---

::: details 数组扁平化

```js
let arr2 = [0, [1], [2, 3], [4, [5, 6, 7]]]; // 数组扁平化
let dimensionReduction = function (arr) {
  return arr.reduce((acc, cur) => {
    return acc.concat(Array.isArray(cur) ? dimensionReduction(cur) : cur);
  }, []);
};

console.log(dimensionReduction(arr2));
```

:::

---

::: details url 参数拼接

```js
/**
 * Add the object as a parameter to the URL
 * @param baseUrl url
 * @param obj
 * @returns {string}
 * eg:
 *  let obj = {a: '3', b: '4'}
 *  setObjToUrlParams('www.baidu.com', obj)
 *  ==>www.baidu.com?a=3&b=4
 */
export function setObjToUrlParams(baseUrl: string, obj: any): string {
  let parameters = "";
  for (const key in obj) {
    parameters += key + "=" + encodeURIComponent(obj[key]) + "&";
  }
  parameters = parameters.replace(/&$/, "");
  return /\?$/.test(baseUrl)
    ? baseUrl + parameters
    : baseUrl.replace(/\/?$/, "?") + parameters;
}
```

:::

---

::: details 深度合并对象

```js
function is(val, type) {
  return toString.call(val) === `[object ${type}]`;
}

function isObject(val) {
  return val !== null && is(val, "Object");
}

/**
 * @param src {object}
 * @param target {object}
 * @return {object}
 */

function deepMerge(src, target) {
  let key;
  for (key in target) {
    src[key] = isObject(src[key])
      ? deepMerge(src[key], target[key])
      : (src[key] = target[key]);
  }
  return src;
}
```

:::



----------------------
<end-time time="新增时间: 2022-11-17 09-05" mood="周四" />

::: details 数组中对象根据id或者其他字段去重

```js
let a = [
  {id: 6, name: '66'},
  {id: 1, name: '11'},
  {id: 2, name: '22'},
  {id: 3, name: '33'},
  {id: 4, name: '44'},
  {id: 5, name: '55'},
  {id: 3, name: '33'},
  {id: 1, name: '11'},
  {id: 4, name: '44'}
]
console.log('a :>> ', a.length); // a :>>  9

let c = b = a;

function unique(arr) {
  const res = new Map()
  return arr.filter(a => !res.has(a.id) && res.set(a.id, 1))
}

b = unique(b)

console.log('b.length :>> ', b.length); // 6

function handleFilter(arr) {
  let obj = {}
  return arr.reduce(function (item, next) {
    obj[next.id] ? '' : obj[next.id] = true && item.push(next)
    return item;
  }, [])
}

console.log('handleFilter :>> ', handleFilter(c).length); // 6
```

:::


----------------

<end-time time="新增时间: 2022-11-19 15:02 周六" />

::: details js中扁平数据与树形数据之间的转换

- 有这样一个需求, 后端给我返回了一个扁平化的数组, 我需要拿到这个数组之后根据固定的规矩去进行转换, 规律如下

```js
let data2 = [
  {id: 1, pid: 0, name: '水果'},
  {id: 2, pid: 0, name: '电脑'},
  {id: 3, pid: 1, name: '热带水果'},
  {id: 4, pid: 3, name: '榴莲'},
  {id: 5, pid: 4, name: '猫山王榴莲'},
  {id: 6, pid: 2, name: 'mac'},
  {id: 7, pid: 6, name: 'm1 pro'},
  {id: 8, pid: 6, name: 'm2 pro'},
  {id: 9, pid: 1, name: '芒果'},
  {id: 10, pid: 9, name: '特价海南大金煌'},
  {id: 11, pid: 9, name: '小台芒'}
]

// 规律: 当数组中的某一项id等于某一项的pid时, 等于pid的那一项放到id那一项的childrens中


// 代码如下

function transformTreeData(data) {
  let TreeData = [], outputObj, pid, oldData = data;
  let map = new Map();

  for (let i = 0; i < data.length; i++) {
    pid = data[i].pid;
    if (map.has(pid)) {
      if (!map.get(pid).childrens) map.get(pid).childrens = []
      let obj = new Object(data[i])
      map.get(pid).childrens.push(obj)
      map.set(data[i].id, obj)
    } else if (!map.has(pid) && pid == 0) {
      console.log('入口')
      outputObj = new Object(data[i])
      TreeData.push(outputObj)
      map.set(data[i].id, outputObj)
    }
  }


  return {
    TreeData,
    oldData
  };
}

const {oldData: oldData1, TreeData: treeData1} = transformTreeData(data2)
console.group('扁平数据->树形结构')
console.log('转换前:', oldData1)
console.log('转换后:', treeData1)
console.groupEnd()


// 数组扁平化

let flatData = oldData1;

function flat(data) {
  let newArr = [];

  for (let i = 0; i < data.length; i++) {
    if (data[i].childrens) {
      newArr.push(...flat(data[i].childrens))
      delete data[i].childrens
    }
    newArr.push({...data[i]})
  }

  return newArr;
}

flat(flatData) // --
```

:::




<end-time time="新增时间: 2022-12-12 15:15" />

::: details 力扣的有效的括号js版

:::