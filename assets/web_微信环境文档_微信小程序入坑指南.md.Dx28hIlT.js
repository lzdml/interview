import{_ as a,c as l,G as p,a0 as e,B as o,o as r}from"./chunks/framework.D62TWaax.js";const m=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"web/微信环境文档/微信小程序入坑指南.md","filePath":"web/微信环境文档/微信小程序入坑指南.md","lastUpdated":1732672553000}'),t={name:"web/微信环境文档/微信小程序入坑指南.md"};function c(i,s,B,y,u,F){const n=o("end-time");return r(),l("div",null,[p(n,{time:"新增时间: 2022-11-21 10:05"}),s[0]||(s[0]=e(`<h3 id="微信小程序遇到的坑" tabindex="-1">微信小程序遇到的坑 <a class="header-anchor" href="#微信小程序遇到的坑" aria-label="Permalink to &quot;微信小程序遇到的坑&quot;">​</a></h3><hr><div class="info custom-block"><p class="custom-block-title">require的路径不支持绝对路径</p><ul><li>问题：在嵌套比较深的目录层级里，引用utils/request.js，需要慢慢../到根目录</li></ul><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> utils</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> require</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;../../../../../utils/index.js&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#7F848E;font-style:italic;">// 需要一直..下去</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li>解决: 在App绑定require, Page里获取app, 直接app.require引入</li></ul><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// in app.js</span></span>
<span class="line"><span style="color:#61AFEF;">App</span><span style="color:#ABB2BF;">({</span></span>
<span class="line"><span style="color:#61AFEF;">  onLaunch</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">  },</span></span>
<span class="line"><span style="color:#61AFEF;">  require</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">path</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#61AFEF;"> require</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">\`</span><span style="color:#C678DD;">\${</span><span style="color:#E06C75;">path</span><span style="color:#C678DD;">}</span><span style="color:#98C379;">\`</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">  },</span></span>
<span class="line"><span style="color:#ABB2BF;">})</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// in page.js</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> app</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> getApp</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> util</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> app</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">require</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;./utils/util.js&#39;</span><span style="color:#ABB2BF;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div></div><hr><div class="info custom-block"><p class="custom-block-title">兼容性问题</p><ol><li>IOS的 <strong>Date构造函数</strong>不支持2022-11-21这种格式的日期, 必须转换为2022/11/21格式</li><li>image组件使用webp图片时, IOS需要设置webp属性</li><li>Android手机在onShow内调用<strong>wx.showModal</strong>, 如果不关闭弹窗(直接点击右上角退出小程序), 弹窗不会销毁, 再次进入页面触发onShow时会出现两次弹窗, IOS正常</li><li>IOS内<strong>page-container</strong>内嵌套<strong>van-popup</strong>类弹出层容器, 会出现弹出层<strong>z-index失效</strong> 问题,可以根据弹出层显示隐藏动态更改<strong>page-container</strong>的<strong>custom-style</strong>设置**-webkit-overflow-scrolling属性**</li><li>小程序中使用<strong>web-view打开pdf</strong>, IOS可以正常打开, Android打开为空白, 解决使用如下代码</li></ol><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#E5C07B;">wx</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">downloadFile</span><span style="color:#ABB2BF;">({</span></span>
<span class="line"><span style="color:#E06C75;">  url</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;https://.../XXX.pdf&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#7F848E;font-style:italic;">//要预览的 PDF 的地址</span></span>
<span class="line"><span style="color:#61AFEF;">  success</span><span style="color:#ABB2BF;">: </span><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">    if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">res</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">statusCode</span><span style="color:#56B6C2;"> ===</span><span style="color:#D19A66;"> 200</span><span style="color:#ABB2BF;">) { </span><span style="color:#7F848E;font-style:italic;">//成功</span></span>
<span class="line"><span style="color:#C678DD;">      var</span><span style="color:#E06C75;"> Path</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> res</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">tempFilePath</span><span style="color:#7F848E;font-style:italic;"> //返回的文件临时地址，用于后面打开本地预览所用</span></span>
<span class="line"><span style="color:#E5C07B;">      wx</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">openDocument</span><span style="color:#ABB2BF;">({</span></span>
<span class="line"><span style="color:#E06C75;">        fileType</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;pdf&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#7F848E;font-style:italic;">// 文件类型</span></span>
<span class="line"><span style="color:#E06C75;">        filePath</span><span style="color:#ABB2BF;">: </span><span style="color:#E06C75;">Path</span><span style="color:#ABB2BF;">, </span><span style="color:#7F848E;font-style:italic;">//要打开的文件路径</span></span>
<span class="line"><span style="color:#61AFEF;">        success</span><span style="color:#ABB2BF;">: </span><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E5C07B;">          console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;打开 PDF 成功&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">      })</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">  },</span></span>
<span class="line"><span style="color:#61AFEF;">  fail</span><span style="color:#ABB2BF;">: </span><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E5C07B;">    console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">err</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">//失败</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"><span style="color:#ABB2BF;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div></div><h4 id="扩展库和插件" tabindex="-1">扩展库和插件 <a class="header-anchor" href="#扩展库和插件" aria-label="Permalink to &quot;扩展库和插件&quot;">​</a></h4><ul><li>UI组件库</li></ul><p><a href="https://link.juejin.cn/?target=https%3A%2F%2Fvant-contrib.gitee.io%2Fvant-weapp%2F%23%2Fhome" target="_blank" rel="noreferrer">Vant Weapp 有赞开源小程序组件库</a><a href="https://link.juejin.cn/?target=https%3A%2F%2Ftdesign.tencent.com%2Fminiprogram%2Fgetting-started" target="_blank" rel="noreferrer">Tdesign 微信小程序组件库</a></p><ul><li>小程序官方拓展库</li></ul><p><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fwechat-miniprogram%2Fminiprogram-api-promise" target="_blank" rel="noreferrer">miniprogram-api-promise 扩展小程序api支持promise</a></p><p><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fwechat-miniprogram%2Frecycle-view" target="_blank" rel="noreferrer">recycle-view 长列表组件</a></p><p><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fwechat-miniprogram%2Fwxml-to-canvas" target="_blank" rel="noreferrer">wxml-to-canvas 小程序内通过静态模板和样式绘制 canvas ，导出图片，可用于生成分享图等场景</a></p><p><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fwechat-miniprogram%2Fminiprogram-component-plus" target="_blank" rel="noreferrer">miniprogram-component-plus 包含vtabs、select-text、sticky等组件</a></p><p><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fwechat-miniprogram%2Flottie-miniprogram" target="_blank" rel="noreferrer">lottie-miniprogram lottie 动画库适配小程序的版本</a></p><p><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2FTencent%2FFace2FaceTranslator%2F" target="_blank" rel="noreferrer">微信同声传译 语音输入，文本翻译插件</a></p><ul><li>其他</li></ul><p><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fsbfkcel%2Ftowxml" target="_blank" rel="noreferrer">可将HTML、Markdown转为微信小程序WXML</a></p><p><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fjin-yufeng%2Fmp-html" target="_blank" rel="noreferrer">mp-html 小程序富文本组件</a></p><ul><li>代码注入优化</li></ul><p><strong>推荐所有小程序通过开启「按需注入」特性避免不必要的代码注入和执行，以降低小程序的启动时间和运行时内存</strong></p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#98C379;">  &quot;lazyCodeLoading&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#98C379;">  &quot;requiredComponents&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div>`,21))])}const d=a(t,[["render",c]]);export{m as __pageData,d as default};
